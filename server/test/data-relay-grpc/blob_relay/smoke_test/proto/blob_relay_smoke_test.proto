syntax = "proto3";
package data_relay_grpc.blob_relay.smoke_test.proto;

// empty message
message Void {}

// unknown error was occurred.
message UnknownError {
    // the error message.
    string message = 1;
}

// copy from data_relay_grpc.blob_relay.proto
message BlobReference {

    // the ID of the storage where the BLOB data is stored.
    uint64 storage_id = 1;

    // the ID of the object within the BLOB storage.
    uint64 object_id = 2;

    // a tag for additional access control.
    uint64 tag = 3;
}

// Create blob relay session
message CreateSessionRequest {
    oneof context_id {
        // the transaction ID.
        uint64 transaction_id = 1;
    }
}
message CreateSessionResponse {
    reserved 1 to 10;

    // the response body.
    oneof result {
        // request is successfully completed.
        uint64 session_id = 12;

        // unknown error was occurred.
        UnknownError unknown_error = 11;
    }
}

// Dispose blob relay session
message DisposeSessionRequest {
    // session id of the target session.
    uint64 session_id = 1;
}
message DisposeSessionResponse {
    reserved 1 to 10;

    // the response body.
    oneof result {
        // request is successfully completed.
        Void success = 12;

        // unknown error was occurred.
        UnknownError unknown_error = 11;
    }
}

// GetFilePath for Blob Reference
message GetFilePathRequest {
    // session id of the target session.
    uint64 session_id = 1;

    // blob id.
    uint64 blob_id = 2;
}
message GetFilePathResponse {
    reserved 1 to 10;

    // the response body.
    oneof result {
        // request is successfully completed and returns file path.
        string path = 12;

        // unknown error was occurred.
        UnknownError unknown_error = 11;
    }
}

// CreateBlobForDownLoad
message CreateBlobForDownLoadRequest {
    // session id of the target session.
    uint64 session_id = 1;

    // transaction id of the target session.
    uint64 transaction_id = 2;

    // file size.
    uint64 size = 3;
}
message CreateBlobForDownLoadResponse {
    reserved 1 to 10;

    // the response body.
    oneof result {
        // request is successfully completed and returns the BlobReference.
        BlobReference blob_reference = 12;

        // unknown error was occurred.
        UnknownError unknown_error = 11;
    }
}

// Support functionality for BlobRelaySmokeTest
service BlobRelaySmokeTestSupport {

    // Create blob relay session
    rpc CreateSession(CreateSessionRequest) returns (CreateSessionResponse);

    // Dispose blob relay session
    rpc DisposeSession(DisposeSessionRequest) returns (DisposeSessionResponse);

    // GetFilePath
    rpc GetFilePath(GetFilePathRequest) returns (GetFilePathResponse);

    // Create a blob file for next down.
    rpc CreateBlobForDownLoad(CreateBlobForDownLoadRequest) returns (CreateBlobForDownLoadResponse);
}
